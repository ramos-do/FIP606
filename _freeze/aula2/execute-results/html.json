{
  "hash": "c43d50c4594d08809ea74d7b93410ace",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 2 - Ler dados de arquivos\"\nauthor: Danilo Oliveira Ramos\nformat: html\n---\n\n\n\n# Ler dados de arquivos\n\n### Dados no Excel\n\nVamos utilizar dois métodos de importação:\n\n-   Leitura de uma planilha local com a função `read_excel()`;\n\n-   Importação direta de planilhas do Google Sheets por meio da função `gsheet2tbl()`, permitindo o acesso a diferentes abas de um mesmo documento online.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##install.packages(\"readxl\")\n##install.packages(\"gsheet2tbl\")\nlibrary(readxl)\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(dplyr)\n\ndados <- read_excel(\"dados-diversos.xlsx\",\n                    sheet = \"sensibilidade_fungicidas\")\n\ndados <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=373270992#gid=373270992\")\n\nsurvey = gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1118819738#gid=1118819738\")\n```\n:::\n\n\n\n### Gerando uma tabela de contingência\n\nUtilizando a função `tabyl()` do pacote `janitor`, vamos construir uma tabela de contingência que resume a frequência de espécies por estado e ano, facilitando a análise descritiva.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##install.packages(\"janitor\")\nlibrary(janitor)\n\nsurvey_b = survey |> \n  group_by(state, species, year) |> \n  mutate(n = n())\nsurvey_b |> \n  tabyl(state, species, year)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`2009`\n state Fgra Fspp\n    PR   92   31\n    RS  133    9\n\n$`2010`\n state Fgra Fspp\n    PR    0    0\n    RS  187   29\n\n$`2011`\n state Fgra Fspp\n    PR   58   35\n    RS   82   10\n```\n\n\n:::\n:::\n\n\n\n### Visualizar os dados\n\nVamos criar um gráfico de barras com `ggplot2`, demonstrando a distribuição temporal do número de registros por espécie. As barras foram preenchidas com cores diferenciadas para cada espécie, utilizando a paleta perceptualmente uniforme `viridis`, adequada para visualizações inclusivas e publicações.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey_b |> \n  group_by(year, species) |> \n  count() |> \n  ggplot(aes(year, n, fill = species,\n             color = species))+\n  geom_col()+\n  scale_fill_viridis_d()\n```\n\n::: {.cell-output-display}\n![](aula2_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#scale_fill_manual(values = c(\"red\", \"blue\"))\n#facet_wrap(~year)\n```\n:::\n\n\n\n## Editar e Exportar Gráficos\n\nVamos elaborar um gráfico do tipo boxplot com sobreposição de pontos individuais (`geom_jitter`) para visualizar a variação dos dados por tratamento. Vamos usar o pacote `ggthemes` para facilitar a personalização estética do gráfico, com alternativas visuais prontas e mais sofisticadas do que os temas padrão do `ggplot2`. Além disso, vamos salvar o gráfico gerado em formato `.png` usando a função `ggsave`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\nlibrary(ggthemes)\nplot_mg <- mg |> \n  ggplot(aes(trat, comp))+\n  geom_boxplot(fill = \"darkgreen\",\n               outlier.color = NA)+\n  geom_jitter(width = 0.1, color = \"gray50\")+\n  scale_y_continuous(limits = c(0,20))+\n  labs(x = \"Tratamentos\",\n       y = \"Comprimento (mm)\",\n       title = \"Efeito do Magnésio\",\n       subtitle = \"Tamanho da lesão de mancha parda\")+\n  theme_clean()\n#theme_classic(base_size = 14)\nggsave(\"box.png\", bg = \"white\", width = 4, height = 4)\n```\n:::\n\n\n\nOs dados da aba `micelial` serão utilizados para representar graficamente a taxa de crescimento micelial de diferentes espécies de fungos. As espécies foram ordenadas com base na mediana da taxa observada, e os dados foram visualizados com um boxplot horizontal. Também foram incluídos os valores individuais como pontos sobrepostos.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\nplot_micelial <- micelial |> \n  ggplot(aes(reorder(especie, tcm), tcm))+\n  geom_boxplot(outlier.colour = NA)+\n  geom_jitter(width = 0.1, color = \"gray20\")+\n  coord_flip()+\n  labs(x = \"\", y = \"Taxa de crescimento micelial (mm/dia)\")+\n  theme_clean()\n```\n:::\n\n\n\n### Combinar Gráficos\n\nOs gráficos gerados anteriormente foram combinados lado a lado utilizando o pacote `patchwork`. Esse pacote permite compor múltiplos gráficos construídos com `ggplot2` de maneira intuitiva, utilizando operadores como `|` (lado a lado) e `/` (empilhados verticalmente).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(patchwork)\n(plot_mg | plot_micelial) +\n  plot_annotation(tag_levels = \"A\")\n```\n\n::: {.cell-output-display}\n![](aula2_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"combo1.png\", bg = \"white\", \n       width = 8, height = 4)\n```\n:::\n\n\n\nA figura resultante foi então salva no diretório de trabalho por meio da função `ggsave()`, com fundo branco e dimensões de 8 x 4 polegadas\\\n\n## Conlcusão\n\nNessa etapa, utilizamos os pacotes: `tidyverse`, `janitor`, `ggplot2`, `patchwork` e `ggthemes` para processar planilhas provenientes de diferentes fontes (locais e online), organizar e sumarizar variáveis categóricas e contínuas, bem como para a construção de visualização de gráficos.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}