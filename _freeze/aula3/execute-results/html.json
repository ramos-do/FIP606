{
  "hash": "2310a9fe098cdfa13f87925367efba90",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 3 - Normalidade de dados\"\nformat: html\neditor: visual\n---\n\n\n\n\n# Testar normalidade dos dados\n\nVamos testar a normalidade dos dados, o que é essencial para aplicar testes paramétricos como o **teste t**. Para isso, são utilizados o teste de **Shapiro-Wilk** (`shapiro.test`) e **histogramas** (`hist`) com o objetivo de verificar a distribuição das variáveis. Também vamos avaliar a **homogeneidade de variâncias** com o `var.test`, outra premissa para o uso de testes t.\n\nVamos começar importando e explorando os dados que serão analisados:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary (gsheet)\ndat_mg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\nlibrary(tidyverse)\ndat_mg |> \n  ggplot(aes(trat, comp))+\n  geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndat_mg2 <- dat_mg |> \n  pivot_wider(names_from = trat, values_from= comp) |> \n  select(-rep)\ndat_mg2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 2\n     Mg2 control\n   <dbl>   <dbl>\n 1   9      13.7\n 2  12.5    15.9\n 3  10      15.7\n 4   8      14.2\n 5  13.2    15.9\n 6  11      16.5\n 7  10.8    18  \n 8   9.5    14.4\n 9  10.8    16.4\n10  10.4    16  \n```\n\n\n:::\n\n```{.r .cell-code}\nattach(dat_mg2) \nt.test(control, Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  control and Mg2\nt = 8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n 3.825607 6.490393\nsample estimates:\nmean of x mean of y \n   15.678    10.520 \n```\n\n\n:::\n\n```{.r .cell-code}\n#Com o attach(), o R passa a reconhecer diretamente as colunas control e Mg2 sem usar o $\n\nattach(dat_mg2)\nt_results <- t.test(control, Mg2)\n\n\nlibrary(report)\nreport(t_results)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between control and Mg2\n(mean of x = 15.68, mean of y = 10.52) suggests that the effect is positive,\nstatistically significant, and large (difference = 5.16, 95% CI [3.83, 6.49],\nt(17.35) = 8.15, p < .001; Cohen's d = 3.65, 95% CI [2.14, 5.12])\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(rstatix)\n\nt_test(comp ~ trat, data = dat_mg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 8\n  .y.   group1  group2    n1    n2 statistic    df           p\n* <chr> <chr>   <chr>  <int> <int>     <dbl> <dbl>       <dbl>\n1 comp  control Mg2       10    10      8.15  17.4 0.000000242\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggpubr)\np <- ggboxplot(\n  dat_mg, x = \"trat\", y = \"comp\",\n  color = \"trat\", palette = \"jco\"\n) + ylim(0, 20)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(control)  # para o grupo controle\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  control\nW = 0.93886, p-value = 0.5404\n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(Mg2)      # para o grupo magnésio\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  Mg2\nW = 0.97269, p-value = 0.9146\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(control, main = \"Histograma - Controle\", col = \"lightblue\")\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(Mg2, main = \"Histograma - Mg2\", col = \"lightgreen\")\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\nvar.test(control, Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  control and Mg2\nF = 0.67654, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.1680428 2.7237436\nsample estimates:\nratio of variances \n         0.6765394 \n```\n\n\n:::\n\n```{.r .cell-code}\n#Premissar para usar o teste T: Testar normalidade e variância homogêneas\n```\n:::\n\n\n\n\n-   No teste de **Shapiro-Wilk** o `p > 0.05`, logo os dados podem ser considerados normais.\n\n-   No **var.test** o valor `p > 0.05`, logo as variâncias são homogêneas.\n\n# Teste t amostras dependentes\n\nVamos analisar o conjunto de dados \"escala\" e realizar o teste t pareado com `t_test` para comparar a acurácia entre dois métodos de avaliação. Os dados são visualizados com `geom_boxplot` e os grupos são filtrados para aplicar o teste de normalidade separadamente em cada um. Caso os dados não sejam normais, utiliza-se o teste de Wilcoxon (`wilcox.test`), equivalente não paramétrico ao teste t.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregar pacote necessário\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(rstatix)  # Para a função t_test()\n\n# Ler os dados da aba 'escala'\nescala <- read_excel(\"dados-diversos.xlsx\", sheet = \"escala\")\n\n# Teste t para amostras pareadas (acurácia entre avaliações)\nt_test(acuracia ~ assessment, \n       data = escala,\n       paired = TRUE,\n       var.equal = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 8\n  .y.      group1 group2     n1    n2 statistic    df       p\n* <chr>    <chr>  <chr>   <int> <int>     <dbl> <dbl>   <dbl>\n1 acuracia Aided1 Unaided    10    10      4.43     9 0.00166\n```\n\n\n:::\n:::\n\n\n\n\n### Boxplot para visualizar a diferença entre avaliações\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala |> \n  ggplot(aes(assessment, acuracia))+ \n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n### Filtrando os dados\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunaided <- escala |> \n  filter(assessment == \"Unaided\") |> \n  pull(acuracia)\n\naided <- escala |> \n  filter(assessment == \"Aided1\") |> \n  pull(acuracia)\n```\n:::\n\n\n\n\n### Teste de igualdade de variâncias\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar.test(unaided, aided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  unaided and aided\nF = 20.879, num df = 9, denom df = 9, p-value = 0.0001082\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  5.186134 84.060116\nsample estimates:\nratio of variances \n          20.87934 \n```\n\n\n:::\n:::\n\n\n\n\n### Verificar distribuição e variância\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(unaided)\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  unaided\nW = 0.77356, p-value = 0.00691\n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(aided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  aided\nW = 0.92775, p-value = 0.4261\n```\n\n\n:::\n:::\n\n\n\n\nNeste conjunto de análises, buscou-se avaliar o efeito de diferentes métodos de avaliação sobre a acurácia de observações utilizando dados provenientes da planilha \"escala\". Inicialmente, realizou-se a verificação das premissas para aplicação do teste t pareado, incluindo a avaliação da normalidade dos dados por meio do teste de Shapiro-Wilk e a homogeneidade de variâncias via `var.test()`.\n\nEm seguida, foi aplicado o teste t para amostras dependentes (pareadas), comparando a acurácia das avaliações \"Unaided\" e \"Aided1\". Os dados foram visualizados por meio de boxplots, permitindo observar graficamente a distribuição das acurácias em cada condição. Também foram utilizados métodos alternativos de teste, como o `t_test()` do pacote `rstatix` e `report()` para a interpretação estatística dos resultados.\n\nAlém disso, cuidados foram tomados quanto à padronização de nomes de categorias da variável `assessment`, uma vez que diferenças de capitalização e possíveis espaços em branco poderiam comprometer a correta filtragem dos dados. Esse aspecto evidenciou a importância da limpeza e padronização das variáveis categóricas para garantir a robustez e confiabilidade dos testes estatísticos subsequentes.\n\nDe forma geral, os procedimentos realizados permitiram comparar de maneira apropriada os métodos avaliativos utilizados, fornecendo evidências quantitativas para apoiar a tomada de decisão quanto à acurácia das observações analisadas.\n\n# Teste equivalente ao t para dados não normais (Wilcoxn) de amostras pareadas\n\nO teste de Wilcoxon para amostras pareadas é uma alternativa não paramétrica ao teste t pareado, utilizado quando os dados não seguem distribuição normal. Ele compara duas medições feitas nos mesmos indivíduos, avaliando se há diferença significativa entre elas. Em vez de usar médias e desvios padrão, ele trabalha com os sinais e ranks das diferenças entre os pares. É ideal para dados dependentes e não normais.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(unaided, aided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum exact test\n\ndata:  unaided and aided\nW = 0, p-value = 1.083e-05\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\n\n\n`p-value = 1.083e-05` =\\> Rejeitamos a hipótese nula\n\nComo o valor de W foi **0**, é um sinal fortíssimo de que os dados de um grupo (provavelmente `aided`) foram sistematicamente maiores que os do outro. Portanto, **o auxílio teve efeito real nos resultados** — e não foi coincidência.\n\n# Praticando os conhecimentos \n\nVamos praticar os conceitos aprendidos para comparar a taxa de crescimento micelial entre diferentes espécies de fungos da planilha \"micelial\". Para isso, vamos começar realizando uma ANOVA. As premissas são verificadas com histogramas, `shapiro.test`, e testes de homogeneidade (Bartlett e Levene). As médias são comparadas com `emmeans`, `cld` e `pwpm`, fornecendo uma interpretação mais detalhada das diferenças.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial <- readxl::read_excel(\"dados-diversos.xlsx\", sheet = \"micelial\")\n\nmicelial |> \n  ggplot(aes(especie, tcm))+\n  geom_boxplot()+\n  geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\nanoval <- aov(tcm ~ especie, data = micelial)\n# outra alternativa : anova <- lm (tcm ~ especie, data = micelial)\nanova(anoval)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(residuals(anoval))\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(residuals(anoval))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(anoval)\nW = 0.9821, p-value = 0.8782\n```\n\n\n:::\n\n```{.r .cell-code}\n#teste de homogeneidade das variancias\nbartlett.test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n\n\n:::\n\n```{.r .cell-code}\nlevene_test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 4\n    df1   df2 statistic     p\n  <int> <int>     <dbl> <dbl>\n1     4    25      1.76 0.169\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\nm <- emmeans(anoval, ~ especie)\nm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n especie emmean     SE df lower.CL upper.CL\n Fasi     1.572 0.0559 25    1.457     1.69\n Faus     1.237 0.0559 25    1.122     1.35\n Fcor     1.322 0.0559 25    1.207     1.44\n Fgra     0.912 0.0559 25    0.797     1.03\n Fmer     1.427 0.0559 25    1.312     1.54\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\nlibrary(multcompView)\ncld(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\npwpm(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Fasi    Faus    Fcor    Fgra    Fmer\nFasi [1.572]  0.0023  0.0302  <.0001  0.3765\nFaus   0.335 [1.237]  0.8169  0.0031  0.1469\nFcor   0.250  -0.085 [1.322]  0.0002  0.6761\nFgra   0.660   0.325   0.410 [0.912]  <.0001\nFmer   0.145  -0.190  -0.105  -0.515 [1.427]\n\nRow and column labels: especie\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}